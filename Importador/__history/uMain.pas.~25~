unit uMain;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, uFTDI, Vcl.Menus, IntfFormPrincipal;

type
  TfrmMain = class(TForm, IFormprincipal)
    MainMenu1: TMainMenu;
    Configuraes1: TMenuItem;
    Sair1: TMenuItem;
    Cadastros1: TMenuItem;
    Empresa1: TMenuItem;
    Banco1: TMenuItem;
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure Empresa1Click(Sender: TObject);
    procedure Banco1Click(Sender: TObject);
    procedure Sair1Click(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    { Private declarations }
    FFTDI: TFTDI;
    procedure SetFTDI(const Value: TFTDI);
    function GetFTDI: TFTDI;
  public
    { Public declarations }
    property FTDI: TFTDI read GetFTDI write SetFTDI;
  end;

var
  frmMain: TfrmMain;

implementation

uses
  uFrmImportacao, uFrmCdEmp, ufConfiguracaoBD;

{$R *.dfm}

procedure TfrmMain.Banco1Click(Sender: TObject);
begin
  FTDI.GetTDI.MostrarFormulario(TfConfiguracaoBD, False);
end;

procedure TfrmMain.Empresa1Click(Sender: TObject);
begin
  FFTDI.GetTDI.MostrarFormulario(TfrmCdEmp, False);
end;

procedure TfrmMain.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  Action := caFree;
end;

procedure TfrmMain.FormCreate(Sender: TObject);
begin
  FFTDI := TFTDI.Create(Self, TfrmImportacao);
end;

procedure TfrmMain.FormDestroy(Sender: TObject);
begin
  FreeAndNil(FFTDI);
end;

function TfrmMain.GetFTDI: TFTDI;
begin
  Result := FFTDI;
end;

procedure TfrmMain.Sair1Click(Sender: TObject);
begin
  Close;
end;

procedure TfrmMain.SetFTDI(const Value: TFTDI);
begin
  Self.FTDI := Value;
end;

end.
